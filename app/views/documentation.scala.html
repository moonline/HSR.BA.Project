@(classesAndMethods: Map[Class[_ <: Controller], List[logics.docs.DocumentationLogic.MethodDocumentation]], logic: logics.docs.DocumentationLogic, exampleDataCreator: logics.docs.ExampleDataCreator)

@main("API documentation") {

<h1>API Documentation for EEPPI</h1>

<h2><a name="authentication">Authentication</a></h2>
<p>
    Some methods need authentication.
    The authentication can be made by providing a cookie generated by <a href="@controllers.user.routes.UserController.login()">@controllers.user.routes.UserController.login().url</a> or by providing HTTP Basic Authentication.
    The HTTP Basic Authentication could be used with something like <a href="@controllers.user.routes.PPTAccountController.readAll()?basicAuth=true">@controllers.user.routes.PPTAccountController.readAll().absoluteURL(request()).replaceAll("^(https?:\\/\\/)","$1username:password@")?basicAuth=true</a>.
    The GET parameter "basicAuth=true" lets the server enable HTTP Basic Authentication.
    A response with status code 401 (Unauthorized) is returned, when authentication information are required but are not provided.
</p>

<h2>Parameters</h2>
<p>
    All method parameters can be passed in two ways:
    <ul>
        <li>Normal POST-data (this is also used in this documentation):
            <pre class="prettyprint"><code class="language-bash">curl --request POST --data "theKey=theValue&theKey2=theValue2" http://localhost:9000/...</code></pre>
        </li>
        <li>As a JSON-object as binary data:
            <pre class="prettyprint"><code class="language-bash">curl -H 'Content-Type: application/json;charset=UTF-8' --data-binary '{"theKey":"theValue","theKey2":"theValue2"}' http://localhost:9000/...</code></pre>
            <p>If it's passed as a JSON-object and some parameter reference another object, the reference can be passed in two ways:</p>
            <ul>
                <li>As a numeric ID of the referenced object:
                    <pre class="prettyprint"><code class="language-bash">curl -H 'Content-Type: application/json;charset=UTF-8' --data-binary '{"id":61,"name":"Example processor","project":<strong>63</strong>,"code":"function(num) { return num*num; }"}' @controllers.ppt.routes.ProcessorController.create().absoluteURL(request())</code></pre>
                </li>
                <li>As a full object containing at least an ID-property:
                    <pre class="prettyprint"><code class="language-bash">curl -H 'Content-Type: application/json;charset=UTF-8' --data-binary '{"id":61,"name":"Example processor","project":<strong>{"id":63,"name":"The Example Project"}</strong>,"code":"function(num) { return num*num; }"}' @controllers.ppt.routes.ProcessorController.create().absoluteURL(request())</code></pre>
                    If it's passed as a full object and the method returns the referenced object again, it's returned as it got passed. However, it's not updated on the server.
                </li>
            </ul>
        </li>
    </ul>
</p>

<h2>Index</h2>
@for((aClass,methods) <- classesAndMethods) {
    <h3>@logic.getHumanFriendlyClassName(aClass)</h3>
    <ul>
    @for(method <- methods) {
        <li><a href='#@{method.call.method}_@logic.getRequestUrl(method, false, logic.getIds(method.queryParameters))'>@method.call.method @logic.getRequestUrl(method, false, logic.getIdsWrapped(method.queryParameters,"<x>"))</a> (@method.queryDescription)</li>
    }
    </ul>
}

<h1>Methods</h1>

@for((aClass,methods) <- classesAndMethods) {
    <h2>@logic.getHumanFriendlyClassName(aClass)</h2>
    @for(method <- methods) {
        <h3><a name='@{method.call.method}_@logic.getRequestUrl(method, false, logic.getIds(method.queryParameters))'>@method.call.method @logic.getRequestUrl(method, false, logic.getIdsWrapped(method.queryParameters,"<x>"))</a></h3>

        @if(method.queryDescription != null) {
            <p>@method.queryDescription</p>
        }

		<p>
        @if(method.requireAuthentication) {
            <a href="#authentication">Authentication</a> is required to use this method.
        }else{
            This method is public and can be used without authentication.
        }
		</p>

        @if(method.queryParameters != null) {
            <h4>Parameters</h4>
            <table>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                @for(parameter <- method.queryParameters) {
                <tr>
                    <td>@parameter.name</td>
                    <td>@parameter.format.getSimpleName</td>
                    <td>@parameter.description</td>
                </tr>
                }
            </table>
        }

        @if(method.queryResponses != null) {
            <h4>Responses</h4>
            <table>
                <tr>
                    <th>Status</th>
                    <th>Description</th>
                </tr>
                @for(response <- method.queryResponses) {
                <tr>
                    <td>@if(response.status>0){@response.status}else{&dash;}</td>
                    <td>@response.description</td>
                </tr>
                }
            </table>
        }

        @if(method.queryExamples != null) {
            @for((example, index) <- method.queryExamples.zipWithIndex) {
                <h4>Example @{index+1}</h4>
				<pre class="prettyprint"><code class="language-bash">@logic.getCurlRequestString(method, example)</code></pre>
                @defining(logic.getResponseString(method, example, exampleDataCreator)) { response=>
                    The previous command
                    @if(response.isRealSimulation){
                        <strong title="This response was calculated live on generation of this documentation.">did</strong>
                    }else{
                        <strong title="This response is not a live result, as a creation of a live one isn't that easy.">would probably</strong>
                    } return with status code <strong>@response.getStatus()@if(response.getStatusText!=null){ (@response.getStatusText())}</strong> and yield@if(response.isRealSimulation){ed} the following@if(!example.description.equals("")){ (@example.description)}:
				<pre class="prettyprint"><code class="language-json">@response.getBody</code></pre>
                }
            }
        }
    }
}

}
